{{template "layout" .}}
{{define "content"}}
<div class="max-w-2xl mx-auto glass-card p-8 border border-white/5 shadow-2xl">
    <div class="mb-10 text-center">
        <h2 class="text-3xl font-mystic text-gold drop-shadow-[0_2px_8px_rgba(251,191,36,0.3)]">새 예약 등록</h2>
        <p class="text-slate-400 mt-2 text-sm tracking-wide">상담 정보를 입력하여 운명의 기록을 생성하세요.</p>
    </div>

    <form action="/save-reservation" method="POST" class="space-y-6">
        
        <div>
            <label class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 px-1">상담자 이름</label>
            <input type="text" name="user_name" placeholder="이름을 입력하세요" required
                class="w-full px-4 py-3 rounded-xl bg-black/20 border border-white/10 text-slate-100 placeholder:text-slate-600 focus:ring-2 focus:ring-amber-500/50 outline-none transition-all">
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 px-1">타로 덱 선택</label>
                <select name="deck_idx" id="deckSelect"
                    class="w-full px-4 py-3 rounded-xl bg-black/20 border border-white/10 text-slate-200 focus:ring-2 focus:ring-amber-500/50 outline-none transition-all cursor-pointer">
                    <option value="" class="bg-slate-900 text-slate-400">덱을 선택해주세요</option>
                    {{range .Decks}}
                    <option value="{{.Idx}}" data-amount="{{.AmountCards}}" class="bg-slate-900 text-slate-200">{{.DeckName}} ({{.AmountCards}}장)</option>
                    {{end}}
                </select>
            </div>

            <div>
                <label class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 px-1">배열법(Spread)</label>
                <select name="way_to_array" 
                    class="w-full px-4 py-3 rounded-xl bg-black/20 border border-white/10 text-slate-200 focus:ring-2 focus:ring-amber-500/50 outline-none transition-all cursor-pointer">
                    <option value="0" class="bg-slate-900 text-slate-200">기본</option>
                    <option value="1" class="bg-slate-900 text-slate-200">신년운세</option>
                </select>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 px-1">총 카드 장 수</label>
                <input type="number" name="amount_cards" id="amountCards" value="3" min="1" max="78"
                    class="w-full px-4 py-3 rounded-xl bg-black/20 border border-white/10 text-slate-200 focus:ring-2 focus:ring-amber-500/50 outline-none transition-all">
            </div>
            <div>
                <label class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 px-1">선택해야 할 카드 장 수</label>
                <input type="number" name="selected_cards" value="10" min="1" max="78"
                    class="w-full px-4 py-3 rounded-xl bg-black/20 border border-white/10 text-slate-200 focus:ring-2 focus:ring-amber-500/50 outline-none transition-all">
            </div>
        </div>

        <div>
            <label class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 px-1">예약 희망 일시</label>
            <input type="datetime-local" name="reservation_at" value="{{.DefaultTime}}" required
                class="w-full px-4 py-3 rounded-xl bg-black/20 border border-white/10 text-slate-200 focus:ring-2 focus:ring-amber-500/50 outline-none transition-all color-scheme-dark">
        </div>

        <div class="pt-6">
            <button type="submit" 
                class="w-full bg-gradient-to-r from-amber-600 to-yellow-500 hover:from-amber-500 hover:to-yellow-400 text-slate-900 font-extrabold py-4 rounded-xl shadow-lg shadow-amber-900/20 transition-all transform active:scale-95 tracking-widest uppercase text-sm">
                예약 저장하기
            </button>
        </div>
    </form>
</div>

<script>
    document.getElementById('deckSelect').addEventListener('change', function() {
        // 선택된 option 엘리먼트를 가져옵니다.
        const selectedOption = this.options[this.selectedIndex];
        // data-amount 속성값을 가져옵니다.
        const amount = selectedOption.getAttribute('data-amount');
        
        if (amount) {
            // 총 카드 장 수 input에 값을 넣어줍니다.
            document.getElementById('amountCards').value = amount;
        }
    });
</script>

<style>
    /* datetime-local의 달력 아이콘 등을 다크모드에 어울리게 설정 */
    .color-scheme-dark {
        color-scheme: dark;
    }
</style>
{{end}}