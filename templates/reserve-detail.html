{{define "content"}}
<div class="max-w-4xl mx-auto pb-20">
    <div class="mb-6 flex items-center justify-between">
        <a href="/reserve-list" class="text-slate-400 hover:text-amber-400 flex items-center text-sm transition-colors">
            â† ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
        </a>
        <form action="/delete-reservation/{{.Res.Idx}}" method="POST" onsubmit="return confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
            <button type="submit" class="px-4 py-2 bg-red-500/10 border border-red-500/20 text-red-400 rounded-lg text-sm font-bold hover:bg-red-500/20 transition-colors">ì‚­ì œ</button>
        </form>
    </div>

    <div class="glass-card overflow-hidden mb-8 shadow-2xl">
        <div class="bg-white/5 p-6 border-b border-white/5">
            <h2 class="text-2xl font-mystic text-gold">{{.Res.UserName}} ë‹˜ì˜ ìƒë‹´ ì •ë³´</h2>
        </div>
        <div class="p-8 grid grid-cols-2 md:grid-cols-4 gap-6">
            <div>
                <label class="text-xs font-bold text-slate-500 uppercase tracking-widest">íƒ€ë¡œ ë±</label>
                <p class="font-semibold text-slate-200 mt-1">{{.Res.DeckName}}</p>
            </div>
            <div>
                <label class="text-xs font-bold text-slate-500 uppercase tracking-widest">ë°°ì—´ë²•</label>
                <p class="font-semibold text-slate-200 mt-1">
                    {{if eq .Res.WayToArray 1}} ì‹ ë…„ìš´ì„¸ {{else}} ê¸°ë³¸ {{end}}
                </p>
            </div>
            <div>
                <label class="text-xs font-bold text-slate-500 uppercase tracking-widest">ì´ ì¹´ë“œ ìˆ˜</label>
                <p class="font-semibold text-amber-400 mt-1">{{.Res.AmountCards}} ì¥</p>
            </div>
            <div>
                <label class="text-xs font-bold text-slate-500 uppercase tracking-widest">ë½‘ì€ ì¹´ë“œ ìˆ˜</label>
                <p class="font-semibold text-amber-400 mt-1">{{.Res.SelectedCards}} ì¥ ì¤‘ {{len .DisplayCards}} ì¥ ì™„ë£Œ</p>
            </div>
            <div class="col-span-2">
                <label class="text-xs font-bold text-slate-500 uppercase tracking-widest">ì˜ˆì•½ ì¼ì‹œ</label>
                <p class="font-semibold text-slate-200 mt-1">{{.Res.ReservationDate}}</p>
            </div>
        </div>
    </div>

    <div class="glass-card mb-8 p-6 border-amber-500/20 shadow-[0_0_20px_rgba(251,191,36,0.05)]">
        <label class="block text-s font-bold text-amber-500/70 uppercase tracking-[0.2em] mb-3 px-1">
            ê³ ê°ìš© ì¹´ë“œ ì„ íƒ ë§í¬
        </label>
        
        <div class="flex flex-col md:flex-row gap-3">
            <div class="flex-1 relative group">
                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                    <span class="text-slate-500 text-sm">ğŸ”—</span>
                </div>
                <input type="text" id="shareUrl" readonly 
                    value="http://localhost:8080/select-cards/{{.Res.EncKey}}"
                    class="w-full pl-11 pr-4 py-3 bg-black/40 border border-white/10 rounded-xl text-indigo-300 text-sm font-mono outline-none focus:border-amber-500/50 transition-all">
            </div>

            <button onclick="copyToClipboard()" 
                class="flex items-center justify-center gap-2 px-6 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-slate-200 text-sm font-bold transition-all active:scale-95 group">
                <span id="copyIcon">ğŸ“‹</span>
                <span id="copyText">ë§í¬ ë³µì‚¬</span>
            </button>
        </div>
        <p class="mt-3 text-[11px] text-slate-500 italic px-1 text-center md:text-left">
            * ì´ ë§í¬ë¥¼ ê³ ê°ì—ê²Œ ì „ë‹¬í•˜ë©´ ì§ì ‘ ì¹´ë“œë¥¼ ë½‘ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </p>
    </div>

    <div class="bg-white/5 border border-white/10 rounded-2xl p-6 mb-8 flex flex-col md:flex-row items-center justify-between gap-4">
        <div>
            <h4 class="block text-s font-bold text-amber-500/70 uppercase tracking-[0.2em]">ì¶”ê°€ ì¹´ë“œ ë½‘ê¸° ìš”ì²­</h4>
            <p class="text-slate-400 text-sm">ê³ ê°ì—ê²Œ ì¶”ê°€ë¡œ ë½‘ê²Œ í•  ì¹´ë“œ ì¥ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
        </div>
        <form action="/add-card-count/{{.Res.Idx}}" method="POST" class="flex gap-2 w-full md:w-auto">
            <input type="number" name="add_count" value="1" min="1" max="10" 
                class="w-full md:w-20 px-3 py-2 bg-black/20 border border-white/10 rounded-lg focus:ring-2 focus:ring-amber-500/50 text-white outline-none">
            <button type="submit" class="bg-amber-500 text-slate-900 px-6 py-2 rounded-lg font-bold hover:bg-amber-400 transition-all shadow-lg shadow-amber-500/20 whitespace-nowrap">
                ì¥ìˆ˜ ì¶”ê°€
            </button>
        </form>
    </div>

    <div class="glass-card shadow-2xl overflow-hidden border border-white/5">
        <div class="bg-white/5 p-4 px-6 flex justify-between items-center border-b border-white/5">
            <h3 class="block text-s font-bold text-amber-500/70 uppercase tracking-[0.2em]">ğŸ”® ê³ ê°ì´ ì„ íƒí•œ ì¹´ë“œ ê²°ê³¼</h3>
            {{if not .DisplayCards}}
            <span class="bg-slate-700 text-slate-300 text-[10px] px-2 py-1 rounded-md uppercase tracking-wider">ëŒ€ê¸° ì¤‘</span>
            {{else}}
            <span class="bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 text-[10px] px-2 py-1 rounded-md uppercase tracking-wider">ì„ íƒ ì™„ë£Œ</span>
            {{end}}
        </div>

        <div class="p-8">
            {{if .DisplayCards}}
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-8">
                {{range .DisplayCards}}
                <div class="flex flex-col items-center">
                    <div class="relative w-full aspect-[2/3] mb-4 group">
                        <div class="absolute -top-2 -left-2 w-6 h-6 bg-amber-500 text-slate-900 text-[10px] font-bold flex items-center justify-center rounded-full z-10 shadow-lg border border-white/20">
                            {{.Position}}
                        </div>
                        <img src="/static{{.ImgPath}}" alt="{{.CardName}}" 
                            class="w-full h-full object-cover rounded-xl shadow-xl border border-white/10 group-hover:scale-105 group-hover:border-amber-500/30 transition-all duration-300">
                    </div>
                    <p class="text-sm font-bold text-amber-100">{{.CardName}}</p>
                    <p class="text-[9px] text-slate-500 mt-1 uppercase tracking-[0.2em]">Position {{.Position}}</p>
                </div>
                {{end}}
            </div>
            {{else}}
            <div class="py-20 text-center">
                <p class="text-slate-500 italic text-sm tracking-wider">ê³ ê°ì´ ì•„ì§ ìš´ëª…ì˜ ì¹´ë“œë¥¼ ì„ íƒí•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
            </div>
            {{end}}
        </div>
    </div>
</div>

<script>
function copyToClipboard() {
    const copyText = document.getElementById("shareUrl");
    
    // í…ìŠ¤íŠ¸ ì„ íƒ ë° ë³µì‚¬
    copyText.select();
    copyText.setSelectionRange(0, 99999); // ëª¨ë°”ì¼ ëŒ€ì‘
    
    try {
        navigator.clipboard.writeText(copyText.value).then(() => {
            // ë³µì‚¬ ì„±ê³µ ì‹œ UI í”¼ë“œë°±
            const btnText = document.getElementById("copyText");
            const btnIcon = document.getElementById("copyIcon");
            
            btnText.innerText = "ë³µì‚¬ ì™„ë£Œ!";
            btnText.classList.add("text-amber-400");
            btnIcon.innerText = "âœ¨";
            
            // 2ì´ˆ ë’¤ ì›ë˜ëŒ€ë¡œ
            setTimeout(() => {
                btnText.innerText = "ë§í¬ ë³µì‚¬";
                btnText.classList.remove("text-amber-400");
                btnIcon.innerText = "ğŸ“‹";
            }, 2000);
        });
    } catch (err) {
        alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì§ì ‘ ì£¼ì†Œë¥¼ ë³µì‚¬í•´ì£¼ì„¸ìš”.");
    }
}
</script>
{{end}}